---
title: 网站诞生记
tags:
	- share
	- blog
categories:
    - helloworld
---
计划搭建一个博客站点。希望博客站点具备如下几个特性：

1. 完全以markdown文档提交。
2. 站点简单，纯磁盘文件系统的，不用数据库。这样使用一个 git 库就可以维护版本历史和备份。
3. 有简单好用的插件自动设置网站风格，最好能自适应PC端手机端阅读。
4. 不需要评论互动功能。

这样首先就把著名的 wordpress 排除在外了（并不说 wordpress不好，只是感觉比较重量级）. 在网上查找一下后，满足这样要求的博客站点框架还真不少。从中选择了 hexo 这个工具。

###  网站架构
<pre>
                                +------------------------------------------+
                                |  i2038.com                               |
                                |                                          |
 +---------+     read blogs     |     +---------+       +-----------+      |
 | readers +------------------------->+  nginx  +------>+ hexo blog |      |
 +---------+         (6)        |     +-+-----+-+  (7)  +-------+---+      |
                                |       ^     |                 ^          |
                                |       |     |(3)              |(5)       |
                                |       |     |                 |          |
                                |       |     |        +--------+-------+  |
                                |       |     +------->+ github webhook |  |
                                |       |              +---+------------+  |
                                |       |                  |               |
                                +------------------------------------------+
                                        |                  |
                                        |                  |
                                     (2)|notify         (4)| pull latest blogs
                                        |                  |
                                        |                  v
                                +-------+------------------+---------------+
                                | github.com                               |
+--------+      push xxblog.md  |                                          |
| author +--------------------->+   https://github.com/qdongxu/hexo-blog   |
+--------+           (1)        |                                          |
+--------+      push layout     |                                          |
| author +--------------------->+   https://github.com/qdongxu/3-hexo      |
+--------+           (1)        +------------------------------------------+
</pre>
> **注：** 上图使用 http://asciiflow.com/ 制作

### 写作流程

由于博客文章本来就是公开的，而且是 markdown 纯文本的, 所以在github上建了一个 git 代码库 保存。 通过github提供的 webhook 通知机制。每当有新文章提交到 github。github推送通知到博客网站。 博客网站接到通知后，从 github 拉取最新的提交，调用 `hexo generate` 命令行生成新的文章列表。读者就可以看到新博客了。

> **注：** hexo本身生成的是静态网页，按理可以直接拷贝到 ngnix 静态目录下，但是我把 hexo/public 下的内容拷贴贝过去后，样式不能正确显示。暂示作罢，还是单独启动了 hexo server。

### 待解决问题

1. 网站安装了 letsencrypt ssl 证书，但是 chrome 和 safari 浏览器都提示网站不安全，还没找到原因，这个有点尴尬了，后面再说吧。
2. 增加留言/评论功能